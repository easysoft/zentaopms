var K=Object.defineProperty;var A=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var R=(a,e,l)=>e in a?K(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l,D=(a,e)=>{for(var l in e||(e={}))Q.call(e,l)&&R(a,l,e[l]);if(A)for(var l of A(e))Y.call(e,l)&&R(a,l,e[l]);return a};var w=(a,e,l)=>new Promise((u,f)=>{var y=c=>{try{x(l.next(c))}catch(g){f(g)}},m=c=>{try{x(l.throw(c))}catch(g){f(g)}},x=c=>c.done?u(c.value):Promise.resolve(c.value).then(y,m);x((l=l.apply(a,e)).next())});import{u as j,W as B,_ as Z}from"./useSync.hook-cae0f7f7.js";import{j as V,d as b,r as s,o as d,m as S,e as t,w as n,p as $,t as N,n as h,z as L,aP as T,c as v,a3 as ee,v as te,a5 as ne,x as ae,R as le,f as i,aa as C,F as q,A as P}from"./index.js";import{i as oe}from"./icon-a9afa6f2.js";import"./plugin-25b8b76b.js";import"./tables_list-a4e5b822.js";const re=b({__name:"FilterItemBox",props:{name:{type:String,required:!1},alone:{type:Boolean,default:!1,required:!1},itemRightStyle:{type:Object,default:()=>{},required:!1},itemBoxStyle:{type:Object,default:()=>{},required:!1}},setup(a){return(e,l)=>{const u=s("n-space"),f=s("n-text");return d(),S("div",{class:"go-config-item-box",style:T(D({},a.itemBoxStyle))},[t(f,{class:"item-left",depth:"2"},{default:n(()=>[$(N(a.name)+" ",1),t(u,null,{default:n(()=>[h(e.$slots,"name",{},void 0,!0)]),_:3})]),_:3}),L("div",{class:"item-right",style:T(D({gridTemplateColumns:a.alone?"1fr":"1fr 1fr"},a.itemRightStyle))},[h(e.$slots,"default",{},void 0,!0)],4)],4)}}});var z=V(re,[["__scopeId","data-v-05d1f298"]]);const se=b({__name:"index",props:{name:{type:String,required:!0},expanded:{type:Boolean,required:!0,default:!1}},setup(a){const e=a,l=u=>{u.preventDefault(),u.stopPropagation()};return(u,f)=>{const y=s("n-collapse-item"),m=s("n-collapse");return d(),v(m,{"arrow-placement":"right","expanded-names":e.expanded?e.name:null,accordion:""},{"header-extra":n(()=>[L("div",{onClick:l},[h(u.$slots,"header")])]),default:n(()=>[t(y,{title:e.name,name:e.name},{default:n(()=>[h(u.$slots,"default")]),_:3},8,["title","name"])]),_:3},8,["expanded-names"])}}});const ie={class:"go-config-item-box"},ue=b({__name:"index",props:{name:{type:String,required:!1},alone:{type:Boolean,default:!1,required:!1},itemRightStyle:{type:Object,default:()=>{},required:!1}},setup(a){return(e,l)=>{const u=s("n-text");return d(),S("div",ie,[t(u,{class:"item-left",depth:"2"},{default:n(()=>[$(N(a.name)+" ",1),h(e.$slots,"name",{},void 0,!0)]),_:3}),L("div",{class:"item-right",style:T(D({gridTemplateColumns:a.alone?"1fr":"1fr 1fr"},a.itemRightStyle))},[h(e.$slots,"default",{},void 0,!0)],4)])}}});var de=V(ue,[["__scopeId","data-v-61259120"]]);const ce=b({__name:"index",props:{filter:{type:Object,required:!0},remove:{type:Function},idx:{type:Number,required:!0}},setup(a){const e=a,{RemoveIcon:l}=oe.ionicons5,{remove:u}=ee(e),f=te([]),y=()=>w(this,null,function*(){if(window.selectOptionApi)try{let _=new FormData;_.append("field",e.filter.field);const p=yield(yield fetch(window.selectOptionApi,{method:"POST",body:_})).json();f.value=p}catch(_){console.error(_)}else f.value=[]}),m={margin:"12px 0"},x=_=>!e.filter.name||e.filter.name.length==0?"\u7B5B\u9009\u5668 - \u672A\u547D\u540D"+_:"\u7B5B\u9009\u5668 - "+e.filter.name,c=j(),g=ne(()=>c.getComponentList.filter(p=>p.chartConfig.sourceID&&p.chartConfig.fields).map(p=>p.chartConfig).map(p=>{const E=[];for(const I in p.fields){const F=p.fields[I];E.push({value:F.field,label:F.name})}const k="diagram-"+p.sourceID;return{key:k,name:p.title,fields:E,expanded:e.filter.diagramIds.includes(k)}}));return ae(()=>{e.filter.type==B.SELECT&&y(),e.filter.name.length==0&&(e.filter.name="\u672A\u547D\u540D"+e.idx)}),le(()=>e.filter.field,(_,r)=>w(this,null,function*(){yield y()})),(_,r)=>{const p=s("n-icon"),E=s("n-button"),k=s("n-select"),I=s("n-tree-select"),F=s("n-input"),O=s("n-date-picker"),H=s("n-checkbox"),U=s("n-gi"),M=s("n-grid"),W=s("n-checkbox-group"),X=s("n-space"),G=s("n-card");return d(),v(G,{title:x(e.idx),size:"small","header-style":{fontSize:"14px"}},{"header-extra":n(()=>[t(E,{quaternary:"",title:"\u79FB\u9664",onClick:i(u)},{default:n(()=>[t(p,{size:"20"},{default:n(()=>[t(i(l))]),_:1})]),_:1},8,["onClick"])]),default:n(()=>[t(i(z),{name:"\u7C7B\u578B",alone:!0,itemBoxStyle:m},{default:n(()=>[t(k,{value:e.filter.type,"onUpdate:value":r[0]||(r[0]=o=>e.filter.type=o),options:e.filter.typeOptions,size:"small"},null,8,["value","options"])]),_:1}),e.filter.type===i(B).SELECT?(d(),v(i(z),{key:0,name:"\u7B5B\u9009\u503C",alone:!0,itemBoxStyle:m},{default:n(()=>[t(I,{options:e.filter.fieldOptions,value:e.filter.field,"onUpdate:value":r[1]||(r[1]=o=>e.filter.field=o),size:"small"},null,8,["options","value"])]),_:1})):C("",!0),t(i(z),{name:"\u540D\u79F0",alone:!0,itemBoxStyle:m},{default:n(()=>[t(F,{value:e.filter.name,"onUpdate:value":r[2]||(r[2]=o=>e.filter.name=o),size:"small",maxlength:"6",minlength:"1","show-count":"",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["value"])]),_:1}),t(i(z),{name:"\u9ED8\u8BA4\u503C",alone:!0,itemBoxStyle:m},{default:n(()=>[e.filter.type===i(B).TEXT?(d(),v(F,{key:0,value:e.filter.defaultValue,"onUpdate:value":r[3]||(r[3]=o=>e.filter.defaultValue=o),size:"small"},null,8,["value"])):C("",!0),e.filter.type===i(B).SELECT?(d(),v(k,{key:1,value:e.filter.defaultValue,"onUpdate:value":r[4]||(r[4]=o=>e.filter.defaultValue=o),options:f.value,size:"small"},null,8,["value","options"])):C("",!0),e.filter.type===i(B).DATE?(d(),v(O,{key:2,value:e.filter.defaultValue,"onUpdate:value":r[5]||(r[5]=o=>e.filter.defaultValue=o),type:"daterange","start-placeholder":"\u5F00\u59CB","end-placeholder":"\u7ED3\u675F",clearable:"",size:"small"},null,8,["value"])):C("",!0),e.filter.type===i(B).DATETIME?(d(),v(O,{key:3,value:e.filter.defaultValue,"onUpdate:value":r[6]||(r[6]=o=>e.filter.defaultValue=o),type:"datetimerange","start-placeholder":"\u5F00\u59CB","end-placeholder":"\u7ED3\u675F",clearable:"",size:"small"},null,8,["value"])):C("",!0)]),_:1}),t(i(Z),{name:"\u5173\u8054\u56FE\u8868",expanded:!0},{default:n(()=>[t(X,{vertical:"",size:[0,10]},{default:n(()=>[t(W,{value:e.filter.diagramIds,"onUpdate:value":r[7]||(r[7]=o=>e.filter.diagramIds=o)},{default:n(()=>[(d(!0),S(q,null,P(i(g),(o,fe)=>(d(),v(M,{key:o.key,"x-gap":"12",cols:12},{default:n(()=>[t(U,{span:1},{default:n(()=>[t(H,{value:o.key},null,8,["value"])]),_:2},1024),t(U,{span:11},{default:n(()=>[t(i(se),{name:o.name,expanded:e.filter.diagramIds.includes(o.key)},{default:n(()=>[t(i(de),{name:"\u5173\u8054\u5B57\u6BB5",alone:!0},{default:n(()=>[t(k,{value:e.filter.diagramFields[o.key],"onUpdate:value":J=>e.filter.diagramFields[o.key]=J,options:o.fields,size:"small"},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1032,["name","expanded"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1},8,["title"])}}});const pe=b({__name:"index",setup(a){const e=j(),l=()=>{e.addFilterList()},u=f=>{e.removeFilter(f)};return(f,y)=>{const m=s("n-button"),x=s("n-space");return d(),S(q,null,[t(m,{class:"btn-add",type:"info",onClick:l},{default:n(()=>[$(" + \u6DFB\u52A0 ")]),_:1}),t(x,{size:[0,10]},{default:n(()=>[(d(!0),S(q,null,P(i(e).getFilters,(c,g)=>(d(),v(i(ce),{key:c.key,idx:g+1,filter:c,remove:()=>u(c.key)},null,8,["idx","filter","remove"]))),128))]),_:1})],64)}}});var ke=V(pe,[["__scopeId","data-v-4274ce7e"]]);export{ke as default};
