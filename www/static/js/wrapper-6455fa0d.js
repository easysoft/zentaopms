var se=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var N=(e,t,n)=>t in e?se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,h=(e,t)=>{for(var n in t||(t={}))ae.call(t,n)&&N(e,n,t[n]);if(D)for(var n of D(t))de.call(t,n)&&N(e,n,t[n]);return e},E=(e,t)=>ie(e,re(t));var $=(e,t,n)=>new Promise((s,i)=>{var d=c=>{try{l(n.next(c))}catch(o){i(o)}},a=c=>{try{l(n.throw(c))}catch(o){i(o)}},l=c=>c.done?s(c.value):Promise.resolve(c.value).then(d,a);l((n=n.apply(e,t)).next())});import{g as ce}from"./storage-e985e0b9.js";import{aG as m,bS as le,j as k,d as z,o as u,m as w,A as U,ad as T,f as r,bT as G,aQ as S,bU as O,bV as q,bW as X,c as p,bX as Y,bY as K,L as J,F as W,v as g,a5 as F,x as P,ab as R,z as f,bZ as v,a6 as x,al as he,e as L,b_ as M,b$ as ue,S as we}from"./index.js";import{t as b,u as Q,c as pe,O as ge,F as ve,d as ye,b as _e,l as fe}from"./useSync.hook-4dae59ad.js";import{i as Se,g as Ce,a as me,b as Re,h as xe,N as Fe,o as ze,f as be}from"./useItem.hook-7b0fd383.js";import"./tables_list-d433d22a.js";import"./plugin-e8ee0eaf.js";import"./icon-1726a2df.js";const Ee=(e,t,n,s)=>{const i=e,d=t,a={width:1,height:1},l=parseFloat((i/d).toFixed(5)),c=()=>{const C=parseFloat((window.innerWidth/window.innerHeight).toFixed(5));n&&(C>l?(a.width=parseFloat((window.innerHeight*l/i).toFixed(5)),a.height=parseFloat((window.innerHeight/d).toFixed(5)),n.style.transform=`scale(${a.width}, ${a.height})`):(a.height=parseFloat((window.innerWidth/l/d).toFixed(5)),a.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${a.width}, ${a.height})`),s&&s(a))},o=b(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},$e=(e,t,n,s)=>{const i=e,d=t,a={width:1,height:1},l=parseFloat((i/d).toFixed(5)),c=()=>{n&&(a.height=parseFloat((window.innerWidth/l/d).toFixed(5)),a.width=parseFloat((window.innerWidth/i).toFixed(5)),n.style.transform=`scale(${a.width}, ${a.height})`,s&&s(a))},o=b(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},Le=(e,t,n,s)=>{const i=e,d=t,a={height:1,width:1},l=parseFloat((i/d).toFixed(5)),c=()=>{n&&(a.width=parseFloat((window.innerHeight*l/i).toFixed(5)),a.height=parseFloat((window.innerHeight/d).toFixed(5)),n.style.transform=`scale(${a.width}, ${a.height})`,s&&s(a))},o=b(()=>{c()},200);return{calcRate:c,windowResize:()=>{window.addEventListener("resize",o)},unWindowResize:()=>{window.removeEventListener("resize",o)}}},ke=(e,t,n,s)=>{const i={width:1,height:1},d=()=>{n&&(i.width=parseFloat((window.innerWidth/e).toFixed(5)),i.height=parseFloat((window.innerHeight/t).toFixed(5)),n.style.transform=`scale(${i.width}, ${i.height})`,s&&s(i))},a=b(()=>{d()},200);return{calcRate:d,windowResize:()=>{window.addEventListener("resize",a)},unWindowResize:()=>{window.removeEventListener("resize",a)}}},Z={},j={echarts:le},ee=e=>{if(!e.events)return{};const t={};for(const i in e.events.baseEvent){const d=e.events.baseEvent[i];d&&(t[i]=Te(d))}const n=e.events.advancedEvents||{},s={[m.VNODE_BEFORE_MOUNT](i){Z[e.id]=i.component;const d=(n[m.VNODE_BEFORE_MOUNT]||"").trim();B(d,i)},[m.VNODE_MOUNTED](i){const d=(n[m.VNODE_MOUNTED]||"").trim();B(d,i)}};return h(h({},t),s)};function Te(e){try{return new Function(`
      return (
        async function(mouseEvent){
          ${e}
        }
      )`)()}catch(t){console.error(t)}}function B(e,t){try{Function(`
      "use strict";
      return (
        async function(e, components, node_modules){
          const {${Object.keys(j).join()}} = node_modules;
          ${e}
        }
      )`)().bind(t==null?void 0:t.component)(t,Z,j)}catch(n){console.error(n)}}const te=(e,t)=>({zIndex:t+1,left:`${e.x}px`,top:`${e.y}px`}),Oe=(e,t)=>({width:`${t?t*e.w:e.w}px`,height:`${t?t*e.h:e.h}px`}),V=(e,t,n)=>e?{width:`${n?n*e.w:e.w}px`,height:`${n?n*e.h-t:e.h-t}px`}:{},ne=e=>({display:e.hide?"none":"block"}),oe=e=>{const t={};return e&&e.overFlowHidden&&(t.overflow="hidden"),t},We=e=>{const t=e.selectColor?{background:e.background}:{background:`url(${e.backgroundImage}) center center / cover no-repeat !important`};return h({position:"relative",width:e.width?`${e.width||100}px`:"100%",height:e.height?`${e.height}px`:"100%"},t)};const Pe=z({__name:"index",props:{groupData:{type:Object,required:!0},themeSetting:{type:Object,required:!0},themeColor:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){return(t,n)=>(u(!0),w(W,null,U(e.groupData.groupList,s=>(u(),w("div",{class:T(["chart-item",r(G)(s.styles.animations)]),key:s.id,style:S(h(h(h(h(h(h({},r(te)(s.attr,e.groupIndex)),r(O)(s.styles)),r(q)(s.styles)),r(ne)(s.status)),r(oe)(s.preview)),r(X)(s.styles)))},[(u(),p(J(s.chartConfig.chartKey),Y({id:s.id,chartConfig:s,themeSetting:e.themeSetting,themeColor:e.themeColor,style:h({},r(Oe)(s.attr))},K(r(ee)(s))),null,16,["id","chartConfig","themeSetting","themeColor","style"]))],6))),128))}});var Ie=k(Pe,[["__scopeId","data-v-3933053a"]]);const He={key:1},De=z({__name:"index",setup(e){const t=g(!1),{initDataPond:n,clearMittDataPondMap:s}=ye(),i=Q(),d=F(()=>i.editCanvasConfig.chartThemeSetting),a=F(()=>{const l=i.editCanvasConfig.chartThemeColor;return pe[l]});return s(),P(()=>{n(i.requestGlobalConfig)}),(l,c)=>(u(!0),w(W,null,U(r(i).componentList,(o,y)=>{var _,C,I,H;return u(),w("div",{key:o.id,class:"chart-item",style:S(h(h(h(h(h(h({},r(te)(o.attr,y)),r(O)(o.styles)),r(q)(o.styles)),r(ne)(o.status)),r(oe)(o.preview)),r(X)(o.styles)))},[r(Se)(o)&&!((_=o.option)!=null&&_.isDeleted)?(u(),p(r(ge),{key:0,title:r(Ce)(o),attr:o.attr,titleSize:r(me)(o),titleStyle:r(Re)(o)},null,8,["title","attr","titleSize","titleStyle"])):R("",!0),r(xe)(o)&&!((C=o.option)!=null&&C.isDeleted)?(u(),p(r(ve),{key:1,class:"filter-content",componentIdx:o.id,attr:o.attr,filters:o.chartConfig.filters,type:o.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):R("",!0),f("div",{class:T(r(G)(o.styles.animations))},[o.isGroup?(u(),p(r(Ie),{key:0,groupData:o,groupIndex:y,themeSetting:r(d),themeColor:r(a)},null,8,["groupData","groupIndex","themeSetting","themeColor"])):(u(),w("div",He,[(I=o.option)!=null&&I.isDeleted?(u(),p(r(Fe),{key:0,item:o,style:S(E(h({},r(V)(o.attr,0)),{lineHeight:o.attr.h+"px"}))},null,8,["item","style"])):R("",!0),(H=o.option)!=null&&H.isDeleted?R("",!0):(u(),p(J(o.chartConfig.chartKey),Y({key:1,id:o.id,chartConfig:o,themeSetting:r(d),themeColor:r(a),style:h({},r(V)(o.attr,r(ze)(o)+r(be)(o))),scrollMode:t.value?"manual":"auto"},K(r(ee)(o))),null,16,["id","chartConfig","themeSetting","themeColor","style","scrollMode"]))]))],2)],4)}),128))}});var A=k(De,[["__scopeId","data-v-64f2dc65"]]);const Ne=e=>{const t=g(),n=g(),s=g(e.editCanvasConfig.width),i=g(e.editCanvasConfig.height);return P(()=>{switch(e.editCanvasConfig.previewScaleType){case v.FIT:(()=>{const{calcRate:d,windowResize:a,unWindowResize:l}=Ee(s.value,i.value,n.value);d(),a(),x(()=>{l()})})();break;case v.SCROLL_Y:(()=>{const{calcRate:d,windowResize:a,unWindowResize:l}=$e(s.value,i.value,n.value,c=>{const o=t.value;o.style.width=`${s.value*c.width}px`,o.style.height=`${i.value*c.height}px`});d(),a(),x(()=>{l()})})();break;case v.SCROLL_X:(()=>{const{calcRate:d,windowResize:a,unWindowResize:l}=Le(s.value,i.value,n.value,c=>{const o=t.value;o.style.width=`${s.value*c.width}px`,o.style.height=`${i.value*c.height}px`});d(),a(),x(()=>{l()})})();break;case v.FULL:(()=>{const{calcRate:d,windowResize:a,unWindowResize:l}=ke(s.value,i.value,n.value);d(),a(),x(()=>{l()})})();break}}),{entityRef:t,previewRef:n}};const Me=z({__name:"index",setup(e){const{dataSyncFetch:t}=_e(),n=Q(),s=fe(()=>he(()=>import("./index-68d47107.js"),["static/js/index-68d47107.js","static/js/useSync.hook-4dae59ad.js","static/css/useSync.hook-e8b8ac51.css","static/js/index.js","static/css/index-c34cea1e.css","static/js/tables_list-d433d22a.js","static/js/plugin-e8ee0eaf.js","static/js/icon-1726a2df.js"])),i=F(()=>h(h({},We(n.editCanvasConfig)),O(n.editCanvasConfig))),d=F(()=>{const c=n.editCanvasConfig.previewScaleType;return c===v.SCROLL_Y||c===v.SCROLL_X}),{entityRef:a,previewRef:l}=Ne(n.getStorageInfo);return P(()=>$(this,null,function*(){yield t("preview")})),(c,o)=>(u(),w(W,null,[f("div",{class:T(`go-preview ${r(n).editCanvasConfig.previewScaleType}`)},[r(d)?(u(),w("div",{key:0,ref_key:"entityRef",ref:a,class:"go-preview-entity"},[f("div",{ref_key:"previewRef",ref:l,class:"go-preview-scale"},[f("div",{style:S(r(i))},[L(r(A))],4)],512)],512)):(u(),w("div",{key:1,ref_key:"previewRef",ref:l,class:"go-preview-scale"},[f("div",{style:S(r(i))},[L(r(A))],4)],512))],2),L(r(s))],64))}});var je=k(Me,[["__scopeId","data-v-187c9882"]]);const Ke=z({__name:"wrapper",setup(e){let t=g(Date.now());return[M.JSON,M.CHART].forEach(n=>{!window.opener||window.opener.addEventListener(n,s=>$(this,null,function*(){const i=yield ce();ue(we.GO_CHART_STORAGE_LIST,[E(h({},s.detail),{id:i.id})]),t.value=Date.now()}))}),(n,s)=>(u(),p(je,{key:r(t)}))}});export{Ke as default};
