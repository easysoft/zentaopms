var It=Object.defineProperty,Ht=Object.defineProperties;var Pt=Object.getOwnPropertyDescriptors;var lt=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var it=(e,n,t)=>n in e?It(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Y=(e,n)=>{for(var t in n||(n={}))$t.call(n,t)&&it(e,t,n[t]);if(lt)for(var t of lt(n))Ut.call(n,t)&&it(e,t,n[t]);return e},we=(e,n)=>Ht(e,Pt(n));var Se=(e,n,t)=>new Promise((a,o)=>{var f=g=>{try{y(t.next(g))}catch(p){o(p)}},h=g=>{try{y(t.throw(g))}catch(p){o(p)}},y=g=>g.done?a(g.value):Promise.resolve(g.value).then(f,h);y((t=t.apply(e,n)).next())});import{u as re,E as ae,d as Ye,c as wt,H as R,l as Be,a as Kt,F as Nt}from"./chartEditStore-f64b45b7.js";import{x as st,a6 as St,bd as Yt,aj as A,c5 as Tt,c6 as xt,cl as dt,ck as Gt,c3 as Ve,cm as q,ca as Ge,ak as Xt,j as ce,d as ue,bT as Ae,f as s,u as Fe,a5 as P,o as D,m as z,n as at,F as pe,A as _e,ad as ie,aJ as se,aa as he,z as W,c as U,w as F,L as me,aI as Qe,aK as Re,aL as Ze,aM as Dt,a4 as rt,y as $e,al as ft,R as fe,r as I,cn as Wt,a3 as Ue,v as Q,co as pt,G as At,H as Ft,e as M,p as Ce,t as de,aB as zt,b0 as qt,cp as ve,cq as Ie,cr as jt,c2 as Jt,cs as Vt,am as Qt,ct as Zt,J as kt,Q as ht,aQ as Xe,X as We,Y as ze,c0 as en,V as tn,cu as nn,cv as on,W as sn,c1 as an,S as Oe,aR as qe}from"./index.js";import{u as ut,d as rn}from"./index-94c71acf.js";import{t as oe,n as un,m as cn,o as He,q as ln,r as ye,s as Pe,v as ct,F as dn,w as fn}from"./index-12b005c5.js";import{a as pn,b as vt,l as hn,g as vn}from"./plugin-5340ba33.js";import{C as gn}from"./index-a706e59d.js";import{u as _n,C as mn}from"./chartLayoutStore-820b26f5.js";import{i as De}from"./icon-43da1fd8.js";import{E as Cn}from"./index-54ee25b7.js";import"./index-dd27fc3a.js";import"./index-8b4ec756.js";import"./tables_list-16bd57ab.js";/* empty css                                                                */import"./SettingItemBox-47fa6e5a.js";import"./CollapseItem-c8fdd4ef.js";import"./useTargetData.hook-2d9c8a4c.js";const Te=re(),yn=()=>{st(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,document.getElementById("go-chart-edit-layout")),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,document.getElementById("go-chart-edit-content"));const e=Te.listenerScale();St(()=>{Te.setEditCanvas(ae.EDIT_LAYOUT_DOM,null),Te.setEditCanvas(ae.EDIT_CONTENT_DOM,null),e()})})};var bt={exports:{}};(function(e){(function(n){var t,a={},o={16:!1,18:!1,17:!1,91:!1},f="all",h={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},y={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},g=function(r){return y[r]||r.toUpperCase().charCodeAt(0)},p=[];for(t=1;t<20;t++)y["f"+t]=111+t;function _(r,l){for(var b=r.length;b--;)if(r[b]===l)return b;return-1}function i(r,l){if(r.length!=l.length)return!1;for(var b=0;b<r.length;b++)if(r[b]!==l[b])return!1;return!0}var c={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function w(r){for(t in o)o[t]=r[c[t]]}function d(r){var l,b,O,G,$,le;if(l=r.keyCode,_(p,l)==-1&&p.push(l),(l==93||l==224)&&(l=91),l in o){o[l]=!0;for(O in h)h[O]==l&&(C[O]=!0);return}if(w(r),!!C.filter.call(this,r)&&l in a){for(le=j(),G=0;G<a[l].length;G++)if(b=a[l][G],b.scope==le||b.scope=="all"){$=b.mods.length>0;for(O in o)(!o[O]&&_(b.mods,+O)>-1||o[O]&&_(b.mods,+O)==-1)&&($=!1);(b.mods.length==0&&!o[16]&&!o[18]&&!o[17]&&!o[91]||$)&&b.method(r,b)===!1&&(r.preventDefault?r.preventDefault():r.returnValue=!1,r.stopPropagation&&r.stopPropagation(),r.cancelBubble&&(r.cancelBubble=!0))}}}function m(r){var l=r.keyCode,b,O=_(p,l);if(O>=0&&p.splice(O,1),(l==93||l==224)&&(l=91),l in o){o[l]=!1;for(b in h)h[b]==l&&(C[b]=!1)}}function u(){for(t in o)o[t]=!1;for(t in h)C[t]=!1}function C(r,l,b){var O,G;O=v(r),b===void 0&&(b=l,l="all");for(var $=0;$<O.length;$++)G=[],r=O[$].split("+"),r.length>1&&(G=H(r),r=[r[r.length-1]]),r=r[0],r=g(r),r in a||(a[r]=[]),a[r].push({shortcut:O[$],scope:l,method:b,key:O[$],mods:G})}function E(r,l){var b,O,G=[],$,le,Ee;for(b=v(r),le=0;le<b.length;le++){if(O=b[le].split("+"),O.length>1&&(G=H(O),r=O[O.length-1]),r=g(r),l===void 0&&(l=j()),!a[r])return;for($=0;$<a[r].length;$++)Ee=a[r][$],Ee.scope===l&&i(Ee.mods,G)&&(a[r][$]={})}}function L(r){return typeof r=="string"&&(r=g(r)),_(p,r)!=-1}function k(){return p.slice(0)}function K(r){var l=(r.target||r.srcElement).tagName;return!(l=="INPUT"||l=="SELECT"||l=="TEXTAREA")}for(t in h)C[t]=!1;function X(r){f=r||"all"}function j(){return f||"all"}function T(r){var l,b,O;for(l in a)for(b=a[l],O=0;O<b.length;)b[O].scope===r?b.splice(O,1):O++}function v(r){var l;return r=r.replace(/\s/g,""),l=r.split(","),l[l.length-1]==""&&(l[l.length-2]+=","),l}function H(r){for(var l=r.slice(0,r.length-1),b=0;b<l.length;b++)l[b]=h[l[b]];return l}function N(r,l,b){r.addEventListener?r.addEventListener(l,b,!1):r.attachEvent&&r.attachEvent("on"+l,function(){b(window.event)})}N(document,"keydown",function(r){d(r)}),N(document,"keyup",m),N(window,"focus",u);var x=n.key;function B(){var r=n.key;return n.key=x,r}n.key=C,n.key.setScope=X,n.key.getScope=j,n.key.deleteScope=T,n.key.filter=K,n.key.isPressed=L,n.key.getPressedKeyCodes=k,n.key.noConflict=B,n.key.unbind=E,e.exports=C})(Yt)})(bt);var Z=bt.exports;const ee=re(),ne=e=>`${Tt.CTRL}+${e}`,Le=e=>`${Tt.SHIFT}+${e}`,J={[A.ARROW_UP]:ne("up"),[A.ARROW_RIGHT]:ne("right"),[A.ARROW_DOWN]:ne("down"),[A.ARROW_LEFT]:ne("left"),[A.COPY]:ne("c"),[A.CUT]:ne("x"),[A.PARSE]:ne("v"),[A.DELETE]:"delete",[A.BACK]:ne("z"),[A.FORWORD]:ne(Le("z")),[A.GROUP]:ne("g"),[A.UN_GROUP]:ne(Le("g")),[A.LOCK]:ne("l"),[A.UNLOCK]:ne(Le("l")),[A.HIDE]:ne("h"),[A.SHOW]:ne(Le("h"))},te=e=>`${xt.CTRL}+${e}`,Me=e=>`${xt.SHIFT}+${e}`,V={[A.ARROW_UP]:te("arrowup"),[A.ARROW_RIGHT]:te("arrowright"),[A.ARROW_DOWN]:te("arrowdown"),[A.ARROW_LEFT]:te("arrowleft"),[A.COPY]:te("c"),[A.CUT]:te("x"),[A.PARSE]:te("v"),[A.DELETE]:te("backspace"),[A.BACK]:te("z"),[A.FORWORD]:te(Me("z")),[A.GROUP]:te("g"),[A.UN_GROUP]:te(Me("g")),[A.LOCK]:te("l"),[A.UNLOCK]:te(Me("l")),[A.HIDE]:te("h"),[A.SHOW]:te(Me("h"))},En=[J.up,J.right,J.down,J.left,J.delete,J.copy,J.cut,J.parse,J.back,J.forward,J.group,J.unGroup,J.lock,J.unLock,J.hide,J.show],wn=[V.up,V.right,V.down,V.left,V.delete,V.copy,V.cut,V.parse,V.back,V.forward,V.group,V.unGroup,V.lock,V.unLock,V.hide,V.show],Sn=()=>{window.$KeyboardActive={ctrl:!1,space:!1},document.onkeydown=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(e.keyCode),n){case 17:window.$KeyboardActive.ctrl=!0;break;case 32:window.$KeyboardActive.space=!0;break}},document.onkeyup=e=>{const{keyCode:n}=e;if(n==32&&e.target==document.body&&e.preventDefault(),[17,32].includes(n)&&window.$KeyboardActive)switch(dt(),n){case 17:window.$KeyboardActive.ctrl=!1;break;case 32:window.$KeyboardActive.space=!1;break}}},Tn=()=>{const n=(t,a)=>{switch(a){case t.up:Z(a,oe(()=>(ee.setMove(A.ARROW_UP),!1),50));break;case t.right:Z(a,oe(()=>(ee.setMove(A.ARROW_RIGHT),!1),50));break;case t.down:Z(a,oe(()=>(ee.setMove(A.ARROW_DOWN),!1),50));break;case t.left:Z(a,oe(()=>(ee.setMove(A.ARROW_LEFT),!1),50));break;case t.delete:Z(a,Ye(()=>(ee.removeComponentList(),!1),50));break;case t.copy:Z(a,Ye(()=>(ee.setCopy(),!1),50));break;case t.cut:Z(a,Ye(()=>(ee.setCut(),!1),50));break;case t.parse:Z(a,oe(()=>(ee.setParse(),!1),50));break;case t.back:Z(a,oe(()=>(ee.setBack(),!1),50));break;case t.forward:Z(a,oe(()=>(ee.setForward(),!1),50));break;case t.group:Z(a,oe(()=>(ee.setGroup(),!1),50));break;case t.unGroup:Z(a,oe(()=>(ee.setUnGroup(),!1),50));break;case t.lock:Z(a,oe(()=>(ee.setLock(),!1),50));break;case t.unLock:Z(a,oe(()=>(ee.setUnLock(),!1),50));break;case t.hide:Z(a,oe(()=>(ee.setHide(),!1),50));break;case t.show:Z(a,oe(()=>(ee.setShow(),!1),50));break}};En.forEach(t=>{n(J,t)}),wn.forEach(t=>{n(V,t)}),Sn()},S=re(),{onClickOutSide:xn}=ut(),Dn=e=>Se(void 0,null,function*(){e.preventDefault();try{pn();const n=e.dataTransfer.getData(Gt.DRAG_KEY);if(!n){vt();return}S.setEditCanvas(ae.IS_CREATE,!1);const t=Ve(n);let a;if(t.sourceID){let f=yield un(t.sourceID,t.category);if(!f){window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...");return}a=f.chartConfig}else a=t;let o=yield cn(a);q(o,e.offsetX-o.attr.w/2,e.offsetY-o.attr.h/2),S.addComponentList(o,!1,!0),S.setTargetSelectChart(o.id),vt()}catch(n){hn(),window.$message.warning("\u56FE\u8868\u6B63\u5728\u7814\u53D1\u4E2D, \u656C\u8BF7\u671F\u5F85...")}}),gt=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")},Ot=(e,n)=>{if(n){S.setTargetSelectChart(n.id);return}S.setTargetSelectChart(void 0)},An=(e,n)=>{var p;if(e.which==2||(p=window.$KeyboardActive)!=null&&p.space)return;Ot();const t=e.offsetX,a=e.offsetY,o=e.screenX,f=e.screenY,h=S.getEditCanvas.scale;S.setMousePosition(void 0,void 0,t,a);const y=He.exports.throttle(_=>{S.setTargetSelectChart(),S.setEditCanvas(ae.IS_SELECT,!0);const i=t+_.screenX-o,c=a+_.screenY-f;S.setMousePosition(i,c);const w={x1:0,y1:0,x2:0,y2:0};i>t&&c>a?(w.x1=t,w.y1=a,w.x2=Math.round(t+(_.screenX-o)/h),w.y2=Math.round(a+(_.screenY-f)/h)):i>t&&c<a?(w.x1=t,w.y1=Math.round(a-(f-_.screenY)/h),w.x2=Math.round(t+(_.screenX-o)/h),w.y2=a):i<t&&c>a?(w.x1=Math.round(t-(o-_.screenX)/h),w.y1=a,w.x2=t,w.y2=Math.round(a+(_.screenY-f)/h)):(w.x1=Math.round(t-(o-_.screenX)/h),w.y1=Math.round(a-(f-_.screenY)/h),w.x2=t,w.y2=a),S.getComponentList.forEach(d=>{if(!S.getTargetChart.selectId.includes(d.id)){const{x:m,y:u,w:C,h:E}=d.attr,L={x1:m,y1:u,x2:m+C,y2:u+E};L.x1-w.x1>=0&&L.y1-w.y1>=0&&L.x2-w.x2<=0&&L.y2-w.y2<=0&&!d.status.lock&&!d.status.hide&&S.setTargetSelectChart(d.id,!0)}})},30),g=()=>{y.cancel(),S.setEditCanvas(ae.IS_SELECT,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",g)},Lt=()=>({mouseClickHandle:(o,f)=>{var h;if(o.preventDefault(),o.stopPropagation(),!f.status.lock&&(h=window.$KeyboardActive)!=null&&h.ctrl)if(S.targetChart.selectId.includes(f.id)){const y=S.targetChart.selectId.filter(g=>g!==f.id);S.setTargetSelectChart(y)}else S.setTargetSelectChart(f.id,!0)},mousedownHandle:(o,f)=>{var u;if(o.preventDefault(),o.stopPropagation(),f.status.lock||(xn(),o.buttons===Ge.LEFT&&((u=window.$KeyboardActive)==null?void 0:u.ctrl)))return;const h=S.getTargetChart.selectId;if(o.buttons===Ge.RIGHT&&h.length>1&&h.includes(f.id)||(S.setTargetSelectChart(f.id),o.buttons===Ge.RIGHT))return;const y=S.getEditCanvas.scale,g=S.getEditCanvasConfig.width,p=S.getEditCanvasConfig.height,_=new Map;S.getTargetChart.selectId.forEach(C=>{const E=S.fetchTargetIndex(C);if(E!==-1){const{x:L,y:k,w:K,h:X}=Xt(S.getComponentList[E]).attr;_.set(C,{x:L,y:k,w:K,h:X})}});const i=o.screenX,c=o.screenY;let w=[];S.getTargetChart.selectId.forEach(C=>{if(!_.has(C))return;const E=S.fetchTargetIndex(C);w.push(He.exports.cloneDeep(S.getComponentList[E]))}),S.setMousePosition(void 0,void 0,i,c);const d=He.exports.throttle(C=>{S.setEditCanvas(ae.IS_DRAG,!0),S.setMousePosition(C.screenX,C.screenY);let E=(C.screenX-i)/y,L=(C.screenY-c)/y;S.getTargetChart.selectId.forEach(k=>{if(!_.has(k))return;const K=S.fetchTargetIndex(k),{x:X,y:j,w:T,h:v}=_.get(k),H=S.getComponentList[K];let N=Math.round(X+E),x=Math.round(j+L);const B=50;N=N<-T+B?-T+B:N,x=x<-v+B?-v+B:x,N=N>g-B?g-B:N,x=x>p-B?p-B:x,H&&(H.attr=Object.assign(H.attr,{x:N,y:x}))})},20),m=()=>{try{S.setMousePosition(0,0,0,0),S.setEditCanvas(ae.IS_DRAG,!1),w.length&&(S.getTargetChart.selectId.forEach(C=>{if(!_.has(C))return;const E=S.fetchTargetIndex(C),L=S.getComponentList[E];w.forEach(k=>{k.id===C&&(k.attr=Object.assign(k.attr,{offsetX:L.attr.x-k.attr.x,offsetY:L.attr.y-k.attr.y}))})}),S.moveComponentList(w)),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",m)}catch(C){console.log(C)}};document.addEventListener("mousemove",d),document.addEventListener("mouseup",m)},mouseenterHandle:(o,f)=>{o.preventDefault(),o.stopPropagation(),S.getEditCanvas.isSelect||S.setTargetHoverChart(f.id)},mouseleaveHandle:(o,f)=>{o.preventDefault(),o.stopPropagation(),S.setEditCanvas(ae.IS_DRAG,!1),S.setTargetHoverChart(void 0)}}),Fn=(e,n,t)=>{e.stopPropagation(),e.preventDefault(),S.setEditCanvas(ae.IS_DRAG,!0);const a=S.getEditCanvas.scale,o=t.x,f=t.y,h=t.w,y=t.h,g=e.screenX,p=e.screenY;S.setMousePosition(g,p);const _=He.exports.throttle(c=>{S.setMousePosition(c.screenX,c.screenY);let w=Math.round((c.screenX-g)/a),d=Math.round((c.screenY-p)/a);const m=/t/.test(n),u=/b/.test(n),C=/l/.test(n),E=/r/.test(n),L=y+(m?-d:u?d:0),k=h+(C?-w:E?w:0);t.h=L>0?L:0,t.w=k>0?k:0,t.x=o+(C?w:0),t.y=f+(m?d:0)},50),i=()=>{S.setEditCanvas(ae.IS_DRAG,!1),S.setMousePosition(0,0,0,0),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",_),document.addEventListener("mouseup",i)};const kn=["onMousedown"],bn=ue({__name:"index",props:{item:{type:Object,required:!0},hiddenPoint:{type:Boolean,required:!1}},setup(e){const n=e;Ae(i=>({"026d39a0":s(h)}));const t=Fe(),a=re(),o=["t","r","b","l","lt","rt","lb","rb"],f=["n","e","s","w","nw","ne","sw","se"],h=P(()=>t.getAppTheme),y=P(()=>n.item.status.lock?!1:n.item.id===a.getTargetChart.hoverId),g=P(()=>{const i=n.item.id;return n.item.status.lock?!1:a.getTargetChart.selectId.find(c=>c===i)}),p=P(()=>n.item.status.lock),_=P(()=>n.item.status.hide);return(i,c)=>(D(),z("div",{class:ie(["go-shape-box",{lock:s(p),hide:s(_)}])},[at(i.$slots,"default",{},void 0,!0),e.hiddenPoint?he("",!0):(D(!0),z(pe,{key:0},_e(s(g)?o:[],(w,d)=>(D(),z("div",{class:ie(`shape-point ${w}`),key:d,style:se(s(ln)(w,d,e.item.attr,f)),onMousedown:m=>s(Fn)(m,w,e.item.attr)},null,46,kn))),128)),W("div",{class:"shape-modal",style:se(s(ye)(e.item.attr))},[W("div",{class:ie(["shape-modal-select",{active:s(g)}])},null,2),W("div",{class:ie(["shape-modal-change",{selectActive:s(g),hoverActive:s(y)}])},null,2)],4)],2))}});var et=ce(bn,[["__scopeId","data-v-5f8854aa"]]);const On={class:"go-edit-group-box"},Ln=ue({__name:"index",props:{groupData:{type:Object,required:!0},groupIndex:{type:Number,required:!0}},setup(e){const n=re(),{handleContextMenu:t}=ut(),{mouseenterHandle:a,mouseleaveHandle:o,mousedownHandle:f,mouseClickHandle:h}=Lt(),y=(_,i,c)=>{const w=d=>i.filter(m=>d.includes(m.key));if(n.getTargetChart.selectId.length>1)return w([A.GROUP,A.DELETE]);{const d=[];c.status.lock?d.push(A.LOCK):d.push(A.UNLOCK),c.status.hide?d.push(A.HIDE):d.push(A.SHOW);const m=[A.UN_GROUP];return[...w(m),rn(),..._.filter(u=>!d.includes(u.key))]}},g=P(()=>{const _=n.getEditCanvasConfig.chartThemeColor;return wt[_]}),p=P(()=>n.getEditCanvasConfig.chartThemeSetting);return(_,i)=>(D(),z("div",On,[(D(),U(s(et),{key:e.groupData.id,"data-id":e.groupData.id,index:e.groupIndex,item:e.groupData,hiddenPoint:!0,class:ie(s(Qe)(e.groupData.styles.animations)),style:se(Y(Y(Y(Y(Y({},s(Pe)(e.groupData.attr,e.groupIndex)),s(ye)(e.groupData.attr)),s(Re)(e.groupData.styles)),s(Ze)(e.groupData.styles)),s(Dt)(e.groupData.styles))),onClick:i[0]||(i[0]=c=>s(h)(c,e.groupData)),onMousedown:i[1]||(i[1]=c=>s(f)(c,e.groupData)),onMouseenter:i[2]||(i[2]=c=>s(a)(c,e.groupData)),onMouseleave:i[3]||(i[3]=c=>s(o)(c,e.groupData)),onContextmenu:i[4]||(i[4]=c=>s(t)(c,e.groupData,y))},{default:F(()=>[(D(!0),z(pe,null,_e(e.groupData.groupList,c=>(D(),U(s(et),{key:c.id,"data-id":c.id,index:e.groupIndex,item:c,hiddenPoint:!0,style:se(Y({},s(Pe)(c.attr,e.groupIndex)))},{default:F(()=>[(D(),U(me(c.chartConfig.chartKey),{class:ie(["edit-content-chart",s(Qe)(c.styles.animations)]),chartConfig:c,themeSetting:s(p),themeColor:s(g),style:se(Y(Y(Y({},s(ye)(c.attr)),s(Re)(c.styles)),s(Ze)(c.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","item","style"]))),128))]),_:1},8,["data-id","index","item","class","style"]))]))}});const Mn={class:"go-edit-align-line"},Bn=ue({__name:"index",setup(e){Ae(d=>({42514545:s(h)}));const n=Fe(),t=re(),a=rt(),o=$e({lineArr:["rowt","rowc","rowb","coll","colc","colr"],select:new Map,sorptioned:{x:!1,y:!1}}),f=d=>d?{left:`${d.x?d.x:0}px`,top:`${d.y?d.y:0}px`}:{},h=P(()=>n.getAppTheme),y=P(()=>a.getChartAlignRange),g=P(()=>t.getEditCanvas[ae.IS_DRAG]),p=(d,m)=>Math.abs(d-m)<=y.value,_=P(()=>t.getTargetChart.selectId),i=P(()=>t.getComponentList[t.fetchTargetIndex()]),c=P(()=>{var d;return((d=i.value)==null?void 0:d.attr)||{}}),w=P(()=>({id:"0",attr:{w:ft(t.getEditCanvasConfig.width),h:ft(t.getEditCanvasConfig.height),x:0,y:0,offsetX:0,offsetY:0,zIndex:0}}));return fe(()=>t.getMousePosition,oe(()=>{try{if(!g.value||_.value.length!==1)return;const d=c.value.w,m=c.value.h,u=c.value.x,C=u+d/2,E=u+d,L=[u,C,E],k=c.value.y,K=k+m/2,X=k+m,j=[k,K,X];o.select.clear(),o.sorptioned.y=!1;const T=t.getComponentList.map(v=>({id:v.id,attr:v.attr}));T.push(w.value),o.lineArr.forEach(v=>{T.forEach(H=>{if(_.value[0]===H.id)return;const N=H.attr.w,x=H.attr.h,B=H.attr.x,r=B+N/2,l=B+N,b=[B,r,l],O=H.attr.y,G=O+x/2,$=O+x,le=[O,G,$];v.includes("rowt")&&(p(k,O)&&(o.select.set(v,{y:O}),q(i.value,u,O)),p(k,G)&&(o.select.set(v,{y:G}),q(i.value,u,G)),p(k,$)&&(o.select.set(v,{y:$}),q(i.value,u,$))),v.includes("rowc")&&(p(K,O)&&(o.select.set(v,{y:O}),q(i.value,u,O-m/2)),p(K,G)&&(o.select.set(v,{y:G}),q(i.value,u,G-m/2)),p(K,$)&&(o.select.set(v,{y:$}),q(i.value,u,$-m/2))),v.includes("rowb")&&(p(X,O)&&(o.select.set(v,{y:O}),q(i.value,u,O-m)),p(X,G)&&(o.select.set(v,{y:G}),q(i.value,u,G-m)),p(X,$)&&(o.select.set(v,{y:$}),q(i.value,u,$-m))),v.includes("coll")&&(p(u,B)&&(o.select.set(v,{x:B}),q(i.value,B,k)),p(u,r)&&(o.select.set(v,{x:r}),q(i.value,r,k)),p(u,l)&&(o.select.set(v,{x:l}),q(i.value,l,k))),v.includes("colc")&&(p(C,B)&&(o.select.set(v,{x:B}),q(i.value,B-d/2,k)),p(C,r)&&(o.select.set(v,{x:r}),q(i.value,r-d/2,k)),p(C,l)&&(o.select.set(v,{x:l}),q(i.value,l-d/2,k))),v.includes("colr")&&(p(E,B)&&(o.select.set(v,{x:B}),q(i.value,B-d,k)),p(E,r)&&(o.select.set(v,{x:r}),q(i.value,r-d,k)),p(E,l)&&(o.select.set(v,{x:l}),q(i.value,l-d,k)))})})}catch(d){console.log(d)}},200),{deep:!0}),fe(()=>g.value,d=>{d||(o.select.clear(),o.sorptioned.y=!1)}),(d,m)=>(D(),z("div",Mn,[(D(!0),z(pe,null,_e(o.lineArr,u=>(D(),z("div",{class:ie(["line",[u.includes("row")?"row":"col",o.select.has(u)&&"visible"]]),key:u,style:se(f(o.select.get(u)))},null,6))),128))]))}});var Rn=ce(Bn,[["__scopeId","data-v-403a9eed"]]);const In=ue({__name:"index",setup(e){return(n,t)=>{const a=I("n-watermark");return D(),U(a,{id:"go-edit-watermark",content:s(Wt),cross:"",selectable:"","font-size":16,"line-height":16,width:500,height:150,"x-offset":12,"y-offset":80,rotate:-15},null,8,["content"])}}});var Hn=ce(In,[["__scopeId","data-v-e5cd93da"]]);const Mt=e=>(At("data-v-71d41248"),e=e(),Ft(),e),Pn=Mt(()=>W("div",{class:"select-background"},null,-1)),$n=Mt(()=>W("div",{class:"select-border"},null,-1)),Un=[Pn,$n],Kn=ue({__name:"index",setup(e){Ae(y=>({c29aca42:s(f)}));const n=Fe(),t=re(),{isSelect:a,scale:o}=Ue(t.getEditCanvas),f=P(()=>n.getAppTheme),h=Q();return fe(()=>t.getMousePosition,y=>{if(!a.value)return;const{startX:g,startY:p,x:_,y:i}=y,c={zIndex:pt,x:0,y:0,w:0,h:0,offsetX:0,offsetY:0};_>g&&i>p?(c.x=g,c.y=p,c.w=Math.round((_-g)/o.value),c.h=Math.round((i-p)/o.value)):_>g&&i<p?(c.x=g,c.w=Math.round((_-g)/o.value),c.h=Math.round((p-i)/o.value),c.y=p-c.h):_<g&&i>p?(c.y=p,c.w=Math.round((g-_)/o.value),c.h=Math.round((i-p)/o.value),c.x=g-c.w):(c.w=Math.round((g-_)/o.value),c.h=Math.round((p-i)/o.value),c.x=g-c.w,c.y=p-c.h),h.value=Y(Y({},Pe(c,pt)),ye(c))},{deep:!0}),(y,g)=>s(a)?(D(),z("div",{key:0,class:"go-edit-select",style:se(h.value)},Un,4)):he("",!0)}});var Nn=ce(Kn,[["__scopeId","data-v-71d41248"]]);const Yn=ue({__name:"index",setup(e){const n=re(),{getEditCanvasConfig:t,getEditCanvas:a}=Ue(n),o=P(()=>({w:t.value.width,h:t.value.height})),f=P(()=>{const y={transform:`scale(${a.value.scale})`};return Y(Y({},ye(o.value)),y)}),h=P(()=>{const y=a.value.isCreate&&{"z-index":99999};return Y(Y({},ye(o.value)),y)});return(y,g)=>(D(),z("div",{class:"go-edit-range go-transition",style:se(s(f)),onMousedown:g[0]||(g[0]=p=>s(An)(p,void 0))},[at(y.$slots,"default",{},void 0,!0),M(s(Hn)),M(s(Rn)),M(s(Nn)),W("div",{class:"go-edit-range-model",style:se(s(h))},null,4)],36))}});var Gn=ce(Yn,[["__scopeId","data-v-52e445d0"]]),Bt=!!(typeof window!="undefined"&&window.document&&window.document.createElement),tt=!1,nt=!1;try{var je={get passive(){return tt=!0},get once(){return nt=tt=!0}};Bt&&(window.addEventListener("test",je,je),window.removeEventListener("test",je,!0))}catch(e){}function Xn(e,n,t,a){if(a&&typeof a!="boolean"&&!nt){var o=a.once,f=a.capture,h=t;!nt&&o&&(h=t.__once||function y(g){this.removeEventListener(n,y,f),t.call(this,g)},t.__once=h),e.addEventListener(n,h,tt?a:f)}e.addEventListener(n,t,a)}function Wn(e,n,t,a){var o=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(n,t,o),t.__once&&e.removeEventListener(n,t.__once,o)}function _t(e,n,t,a){return Xn(e,n,t,a),function(){Wn(e,n,t,a)}}var mt=new Date().getTime();function zn(e){var n=new Date().getTime(),t=Math.max(0,16-(n-mt)),a=setTimeout(e,t);return mt=n,a}var qn=["","webkit","moz","o","ms"],Ct=zn,yt=function(n,t){return n+(n?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};Bt&&qn.some(function(e){var n=yt(e,"request");return n in window&&(yt(e,"cancel"),Ct=function(a){return window[n](a)}),!!Ct});Function.prototype.bind.call(Function.prototype.call,[].slice);Function.prototype.bind.call(Function.prototype.call,[].slice);const jn={class:"go-sketch-rule"},Jn={key:1,class:"fix-edit-screens-block"},Vn=ue({__name:"index",setup(e){Ae(x=>({"6f694401":s(K),ed8dd9a8:s(L),"58b617f4":c.value}));const n=re(),t=_n(),a=Fe(),o=20;let f=[0,0],h=[0,0];const y=Q(),g=Q(!0),p=Q(),_=Q(),i=Q(!1),c=Q("auto"),{width:w,height:d}=Ue(n.getEditCanvasConfig),m=Q(0),u=Q(0),C=$e({h:[],v:[]}),E=P(()=>n.getEditCanvas.scale),L=P(()=>`${d.value*2}px`),k=P(()=>a.getDarkTheme?{bgColor:"#18181c",longfgColor:"#4d4d4d",shortfgColor:"#4d4d4d",fontColor:"#4d4d4d",shadowColor:"#18181c",borderColor:"#18181c",cornerActiveColor:"#18181c"}:{}),K=P(()=>a.getAppTheme),X=x=>{if(x.ctrlKey||x.metaKey){x.preventDefault();let B=E.value;if(x.wheelDelta>=0&&E.value<2){B=E.value+.05,n.setScale(B);return}x.wheelDelta<0&&E.value>.1&&(B=E.value-.05,n.setScale(B))}},j=()=>{if(!y.value)return;const x=y.value.getBoundingClientRect(),B=p.value.getBoundingClientRect();m.value=(x.left+o-B.left)/E.value,u.value=(x.top+o-B.top)/E.value},T=x=>{var O,G;if(x.preventDefault(),x.stopPropagation(),x.which==2)i.value=!0;else if(!((O=window.$KeyboardActive)!=null&&O.space))return;(G=document.activeElement)==null||G.blur();const B=x.pageX,r=x.pageY,l=_t(window,"mousemove",$=>{const le=$.pageX-B,Ee=$.pageY-r,[Ke,ke]=f,[Ne,be]=h;f=[ke,le],h=[be,Ee],y.value.scrollLeft-=ke>Ke?Math.abs(ke-Ke):-Math.abs(ke-Ke),y.value.scrollTop-=be>Ne?Math.abs(be-Ne):-Math.abs(be-Ne)}),b=_t(window,"mouseup",()=>{l(),b(),f=[0,0],h=[0,0],i.value=!1})},v=()=>{const x=document.getElementById("go-chart-edit-layout");return x?{height:x.clientHeight-25,width:x.clientWidth}:{width:w.value,height:d.value}},H=()=>{g.value=!1,setTimeout(()=>{g.value=!0},10)},N=()=>{const{width:x,height:B}=_.value.getBoundingClientRect(),{width:r,height:l}=v();y.value.scrollLeft=x/2-r/2,y.value.scrollTop=B/2-l/2};return fe(()=>a.getDarkTheme,()=>{H()}),fe(()=>E.value,(x,B)=>{B!==x?(t.setItemUnHandle(mn.RE_POSITION_CANVAS,!1),j(),setTimeout(()=>{N(),H()},400)):oe(H,20)}),fe(()=>i.value,x=>{c.value=x?"grab":"auto"}),st(()=>{y.value&&(y.value.addEventListener("wheel",X,{passive:!1}),N())}),St(()=>{y.value&&y.value.removeEventListener("wheel",X)}),window.onKeySpacePressHold=x=>{i.value=x},(x,B)=>{const r=I("sketch-rule");return D(),z("div",jn,[g.value?(D(),U(r,{key:0,thick:o,scale:s(E),width:v().width,height:v().height,startX:m.value,startY:u.value,lines:C,palette:s(k)},null,8,["scale","width","height","startX","startY","lines","palette"])):he("",!0),W("div",{ref_key:"$app",ref:y,class:"edit-screens",onScroll:j},[W("div",{ref_key:"$container",ref:_,class:"edit-screen-container",style:se({width:s(w)*2+"px"})},[W("div",{ref_key:"refSketchRuleBox",ref:p,class:"canvas",onMousedown:T,style:se({marginLeft:"-"+(v().width/2-25)+"px"})},[W("div",{style:se({pointerEvents:i.value?"none":"auto"})},[at(x.$slots,"default",{},void 0,!0)],4)],36)],4)],544),s(a).getDarkTheme?(D(),z("div",Jn)):he("",!0)])}}});var Qn=ce(Vn,[["__scopeId","data-v-12b70182"]]);const Je={[R.ADD]:"\u65B0\u589E",[R.DELETE]:"\u5220\u9664",[R.UPDATE]:"\u66F4\u65B0",[R.MOVE]:"\u79FB\u52A8",[R.PASTE]:"\u7C98\u8D34",[R.COPY]:"\u590D\u5236",[R.CUT]:"\u526A\u5207",[R.TOP]:"\u7F6E\u9876",[R.BOTTOM]:"\u7F6E\u5E95",[R.UP]:"\u4E0A\u79FB",[R.DOWN]:"\u4E0B\u79FB",[R.GROUP]:"\u6210\u7EC4",[R.UN_GROUP]:"\u89E3\u7EC4",[R.LOCK]:"\u9501\u5B9A",[R.UNLOCK]:"\u89E3\u9501",[R.HIDE]:"\u9690\u85CF",[R.SHOW]:"\u663E\u793A",[Be.CANVAS]:"\u753B\u5E03\u521D\u59CB\u5316"};var Zn=Array.prototype,eo=Zn.reverse;function to(e){return e==null?e:eo.call(e)}var no=to;const Rt=e=>(At("data-v-5a4fd660"),e=e(),Ft(),e),oo={class:"go-flex-items-center"},so=Rt(()=>W("span",{class:"btn-text"},"\u5386\u53F2\u8BB0\u5F55",-1)),ao={class:"history-list-box"},ro=["title"],uo=Rt(()=>W("div",{class:"popover-modal"},null,-1)),co=ue({__name:"index",setup(e){const{DesktopOutlineIcon:n,PencilIcon:t,TrashIcon:a,CopyIcon:o,LayersIcon:f,DuplicateIcon:h,HelpOutlineIcon:y,LockClosedOutlineIcon:g,LockOpenOutlineIcon:p,EyeOffOutlineIcon:_,EyeOutlineIcon:i}=De.ionicons5,{StackedMoveIcon:c,Carbon3DCursorIcon:w,Carbon3DSoftwareIcon:d}=De.carbon,m=Kt(),u=L=>{if(L.targetType===Be.CANVAS)return n;switch(L.actionType){case R.UPDATE:return t;case R.DELETE:return a;case R.PASTE:return o;case R.TOP:return f;case R.BOTTOM:return f;case R.UP:return f;case R.DOWN:return f;case R.MOVE:return c;case R.ADD:return h;case R.GROUP:return w;case R.UN_GROUP:return d;case R.LOCK:return g;case R.UNLOCK:return p;case R.HIDE:return _;case R.SHOW:return i;default:return t}},C=L=>{if(L.targetType===Be.CANVAS)return Je[Be.CANVAS];if(L.actionType===R.GROUP||L.actionType===R.UN_GROUP)return`${Je[L.actionType]}`;if(L.historyData.length)return`${Je[L.actionType]} - ${L.historyData[0].chartConfig.title}`},E=P(()=>{const k=m.getBackStack.map(K=>({label:C(K),icon:u(K)}));return no(k.filter(K=>K.label))});return(L,k)=>{const K=I("n-button"),X=I("n-icon"),j=I("n-text"),T=I("n-scrollbar"),v=I("n-popover"),H=I("n-tooltip");return D(),z("div",oo,[M(v,{class:"edit-history-popover","show-arrow":!1,size:"small",trigger:"click",placement:"top-start"},{trigger:F(()=>[M(K,{class:"mr-10",secondary:"",size:"small",disabled:s(E).length===0},{default:F(()=>[so]),_:1},8,["disabled"])]),default:F(()=>[W("div",ao,[M(T,{style:{"max-height":"500px"}},{default:F(()=>[(D(!0),z(pe,null,_e(s(E),(N,x)=>(D(),z("div",{class:"list-item go-flex-items-center go-ellipsis-1",key:x,title:N.label},[M(X,{class:"item-icon",size:"16",depth:2,component:N.icon},null,8,["component"]),M(j,{depth:"2"},{default:F(()=>[Ce(de(N.label),1)]),_:2},1024)],8,ro))),128))]),_:1}),uo])]),_:1}),M(H,{trigger:"hover"},{trigger:F(()=>[M(X,{size:"21",depth:3},{default:F(()=>[M(s(y))]),_:1})]),default:F(()=>[W("span",null,"\u6700\u591A\u53EA\u4FDD\u7559"+de(s(zt))+"\u6761\u8BB0\u5F55",1)]),_:1})])}}});var lo=ce(co,[["__scopeId","data-v-5a4fd660"]]);const io={class:"go-edit-bottom"},fo=ue({__name:"index",setup(e){Ae(u=>({f3add9fc:o.value}));const{LockClosedOutlineIcon:n,LockOpenOutlineIcon:t}=De.ionicons5,a=Fe(),o=Q(a.getAppTheme),f=re(),{lockScale:h,scale:y}=Ue(f.getEditCanvas);let g=[{label:"200%",value:200},{label:"150%",value:150},{label:"100%",value:100},{label:"50%",value:50},{label:"\u81EA\u9002\u5E94",value:0}];const p=Q(""),_=u=>{if(u===0){f.computedScale();return}f.setScale(u/100)},i=()=>{f.setEditCanvas(ae.LOCK_SCALE,!h.value)},c=Q(100),w=u=>`${u}%`,d=u=>{f.setScale(u/100)},m=$e({100:""});return qt(()=>{const u=(y.value*100).toFixed(0);p.value=`${u}%`,c.value=parseInt(u)}),(u,C)=>{const E=I("n-text"),L=I("n-space"),k=I("n-select"),K=I("n-icon"),X=I("n-button"),j=I("n-tooltip"),T=I("n-slider");return D(),z("div",io,[M(L,null,{default:F(()=>[M(s(lo)),M(E,{id:"keyboard-dress-show",depth:"3"})]),_:1}),M(L,{class:"bottom-ri"},{default:F(()=>[M(Cn),M(k,{disabled:s(h),class:"scale-btn",value:p.value,"onUpdate:value":[C[0]||(C[0]=v=>p.value=v),_],size:"mini",options:s(g)},null,8,["disabled","value","options"]),M(j,{trigger:"hover"},{trigger:F(()=>[M(X,{onClick:i,text:""},{default:F(()=>[M(K,{class:ie(["lock-icon",{color:s(h)}]),size:"18",depth:2},{default:F(()=>[s(h)?(D(),U(s(n),{key:0})):(D(),U(s(t),{key:1}))]),_:1},8,["class"])]),_:1})]),default:F(()=>[W("span",null,de(s(h)?"\u89E3\u9501":"\u9501\u5B9A")+"\u5F53\u524D\u6BD4\u4F8B",1)]),_:1}),M(T,{class:"scale-slider",value:c.value,"onUpdate:value":[C[1]||(C[1]=v=>c.value=v),d],"default-value":50,min:10,max:200,step:5,"format-tooltip":w,disabled:s(h),marks:m},null,8,["value","disabled","marks"])]),_:1})])}}});var po=ce(fo,[["__scopeId","data-v-99a534fc"]]);const ho=ue({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow"],setup(e,{emit:n}){const t=e,{HelpOutlineIcon:a,CloseIcon:o}=De.ionicons5,f=rt(),h=Q(!1),y=$e([{key:ve.ASIDE_ALL_COLLAPSED,value:f.getAsideAllCollapsed,type:"switch",name:"\u83DC\u5355\u6298\u53E0",desc:"\u9996\u9875\u83DC\u5355\u6298\u53E0\u65F6\u9690\u85CF\u81F3\u754C\u9762\u5916"},{key:ve.HIDE_PACKAGE_ONE_CATEGORY,value:f.getHidePackageOneCategory,type:"switch",name:"\u9690\u85CF\u5206\u7C7B",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u8868\u5355\u5206\u7C7B\u53EA\u6709\u5355\u9879\u65F6\u9690\u85CF"},{key:ve.CHANGE_LANG_RELOAD,value:f.getChangeLangReload,type:"switch",name:"\u5207\u6362\u8BED\u8A00",desc:"\u5207\u6362\u8BED\u8A00\u91CD\u65B0\u52A0\u8F7D\u9875\u9762",tip:"\u82E5\u9047\u5230\u90E8\u5206\u533A\u57DF\u8BED\u8A00\u5207\u6362\u5931\u8D25\uFF0C\u5219\u5EFA\u8BAE\u5F00\u542F"},{key:"divider1",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_TOOLS_STATUS_HIDE,value:f.getChartToolsStatusHide,type:"switch",name:"\u9690\u85CF\u5DE5\u5177\u680F",desc:"\u9F20\u6807\u79FB\u5165\u65F6\uFF0C\u4F1A\u5C55\u793A\u5207\u6362\u5230\u5C55\u5F00\u6A21\u5F0F"},{key:ve.CHART_TOOLS_STATUS,value:f.getChartToolsStatus,type:"select",name:"\u5DE5\u5177\u680F\u5C55\u793A",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u5DE5\u5177\u680F\u5C55\u793A\u65B9\u5F0F",options:[{label:"\u4FA7\u8FB9\u680F",value:Ie.ASIDE},{label:"\u5E95\u90E8 Dock",value:Ie.DOCK}]},{key:"divider0",type:"divider",name:"",desc:"",value:""},{key:ve.CHART_MOVE_DISTANCE,value:f.getChartMoveDistance,type:"number",name:"\u79FB\u52A8\u8DDD\u79BB",min:1,step:1,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u65B9\u5411\u952E\u63A7\u5236\u79FB\u52A8\u8DDD\u79BB"},{key:ve.CHART_ALIGN_RANGE,value:f.getChartAlignRange,type:"number",name:"\u5438\u9644\u8DDD\u79BB",min:10,step:2,suffix:"px",desc:"\u5DE5\u4F5C\u7A7A\u95F4\u79FB\u52A8\u56FE\u8868\u65F6\u7684\u5438\u9644\u8DDD\u79BB"}]);fe(()=>t.modelShow,_=>{h.value=_});const g=()=>{n("update:modelShow",!1)},p=(_,i)=>{f.setItem(i.key,i.value)};return(_,i)=>{const c=I("n-h3"),w=I("n-icon"),d=I("n-space"),m=I("n-divider"),u=I("n-text"),C=I("n-switch"),E=I("n-input-number"),L=I("n-select"),k=I("n-tooltip"),K=I("n-list-item"),X=I("n-list"),j=I("n-modal");return D(),U(j,{show:h.value,"onUpdate:show":i[0]||(i[0]=T=>h.value=T),onAfterLeave:g},{default:F(()=>[M(X,{bordered:"",class:"go-system-setting"},{header:F(()=>[M(d,{justify:"space-between"},{default:F(()=>[M(c,{class:"go-mb-0"},{default:F(()=>[Ce("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1}),M(w,{size:"20",class:"go-cursor-pointer",onClick:g},{default:F(()=>[M(s(o))]),_:1})]),_:1})]),default:F(()=>[(D(!0),z(pe,null,_e(y,T=>(D(),U(K,{key:T.key},{default:F(()=>[T.type==="divider"?(D(),U(m,{key:0,style:{margin:"0"}})):(D(),U(d,{key:1,size:40},{default:F(()=>[M(d,null,{default:F(()=>[M(u,{class:"item-left"},{default:F(()=>[Ce(de(T.name),1)]),_:2},1024),T.type==="switch"?(D(),U(C,{key:0,value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],size:"small"},null,8,["value","onUpdate:value"])):T.type==="number"?(D(),U(E,{key:1,value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],class:"input-num-width",size:"small",step:T.step||null,suffix:T.suffix||null,min:T.min||0},null,8,["value","onUpdate:value","step","suffix","min"])):T.type==="select"?(D(),U(L,{key:2,class:"select-min-width",value:T.value,"onUpdate:value":[v=>T.value=v,v=>p(v,T)],size:"small",options:T.options},null,8,["value","onUpdate:value","options"])):he("",!0)]),_:2},1024),M(d,null,{default:F(()=>[M(u,{class:"item-right"},{default:F(()=>[Ce(de(T.desc),1)]),_:2},1024),T.tip?(D(),U(k,{key:0,trigger:"hover"},{trigger:F(()=>[M(w,{size:"21"},{default:F(()=>[M(s(a))]),_:1})]),default:F(()=>[W("span",null,de(T.tip),1)]),_:2},1024)):he("",!0)]),_:2},1024)]),_:2},1024))]),_:2},1024))),128))]),_:1})]),_:1},8,["show"])}}});var vo=ce(ho,[["__scopeId","data-v-7cea0aa5"]]);const xe=re(),go=()=>{xe.setTargetSelectChart(void 0),jt(Jt(xe.getStorageInfo||[]),void 0,"json");const e=document.querySelector(".go-edit-range"),n=document.getElementById("go-edit-watermark");if(!e||!n){window.$message.error("\u5BFC\u51FA\u5931\u8D25\uFF01");return}const t=xe.getEditCanvas.scale;xe.setScale(1,!0),n.style.display="block",setTimeout(()=>{Vt(e,()=>{n&&(n.style.display="none"),xe.setScale(t,!0)})},600)};var ot=(e=>(e.TXT="text/plain",e.JSON="application/json",e.PNG="image/png",e.JPEG="image/jpeg",e.GIF="image/gif",e))(ot||{});const _o=()=>{const e=Q(),{updateComponent:n}=ct();return{importUploadFileListRef:e,importBeforeUpload:({file:o})=>{e.value=[];const f=o.file.type;return f!==ot.JSON&&f!==ot.TXT?(window.$message.warning("\u4EC5\u652F\u6301\u4E0A\u4F20 \u3010JSON\u3011 \u683C\u5F0F\u6587\u4EF6\uFF0C\u8BF7\u91CD\u65B0\u4E0A\u4F20\uFF01"),!1):!0},importCustomRequest:o=>{const{file:f}=o;Qt(()=>{f.file?Zt(f.file).then(h=>{vn({message:"\u8BF7\u9009\u62E9\u5BFC\u5165\u65B9\u5F0F:",positiveText:"\u65B0\u589E\uFF08\u53EF\u64A4\u56DE\uFF09",negativeText:"\u8986\u76D6\uFF08\u4E0D\u53EF\u64A4\u56DE\uFF09",negativeButtonProps:{type:"info",ghost:!1},onPositiveCallback:()=>Se(void 0,null,function*(){try{h=Ve(h),yield n(h,!1,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}}),onNegativeCallback:()=>Se(void 0,null,function*(){try{h=Ve(h),yield n(h,!0,!0),window.$message.success("\u5BFC\u5165\u6210\u529F\uFF01")}catch(y){console.log(y),window.$message.error("\u7EC4\u4EF6\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6587\u4EF6\u5B8C\u6574\u6027!")}})})}):window.$message.error("\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u6570\u636E\u6216\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")})}}},{updateComponent:mo,dataSyncUpdate:Et}=ct(),Co=re(),yo=()=>{const e=f=>mo(f.detail,!0,!1),n=()=>Se(void 0,null,function*(){Et&&(yield Et()),dispatchEvent(new CustomEvent(Xe.CHART,{detail:Co.getStorageInfo}))}),t=()=>{addEventListener("blur",n),addEventListener(Xe.JSON,e)},a=()=>{removeEventListener(Xe.JSON,e),removeEventListener("blur",n)};return(f,h)=>{h==ht.CHART_HOME_NAME&&a(),f==ht.CHART_HOME_NAME&&t()}},Eo=()=>{const e=kt();fe(()=>e.name,yo(),{immediate:!0})};var ge=(e=>(e.BUTTON="button",e.IMPORTUPLOAD="importUpload",e))(ge||{});const wo={class:"btn-item"},So=ue({__name:"index",setup(e){const{DownloadIcon:n,ShareIcon:t,PawIcon:a,SettingsSharpIcon:o,CreateIcon:f}=De.ionicons5,h=rt(),y=re();kt(),Eo();let g=null;const p=Q(!1),_=Q(!0),i=Q(!0),{importUploadFileListRef:c,importCustomRequest:w,importBeforeUpload:d}=_o(),m=P(()=>h.getChartToolsStatus===Ie.ASIDE),u=P(()=>h.getChartToolsStatusHide),C=P(()=>_.value&&u.value),E=P(()=>{if(!m.value)return j;const T=[];return j.map(v=>{T.unshift(v)}),T}),L=()=>{g=setTimeout(()=>{_.value&&(_.value=!1,i.value=!0)},200),setTimeout(()=>{i.value=!1},400)},k=()=>{clearTimeout(g),_.value||(_.value=!0)},K=()=>{window.$message.warning("\u5C06\u5F00\u542F\u5931\u7126\u66F4\u65B0\uFF01"),setTimeout(()=>{const T=tn(nn.CHART_EDIT_NAME,"href");if(!T)return;const v=on();X(v),sn(T,[v],void 0,!0)},1e3)},X=T=>{const v=y.getStorageInfo,H=an(Oe.GO_CHART_STORAGE_LIST)||[];if(H!=null&&H.length){const N=H.findIndex(x=>x.id===T);N!==-1?(H.splice(N,1,we(Y({},v),{id:T})),qe(Oe.GO_CHART_STORAGE_LIST,H)):(H.push(we(Y({},v),{id:T})),qe(Oe.GO_CHART_STORAGE_LIST,H))}else qe(Oe.GO_CHART_STORAGE_LIST,[we(Y({},v),{id:T})])},j=[{key:"import",type:ge.IMPORTUPLOAD,name:"\u5BFC\u5165",icon:t},{key:"export",type:ge.BUTTON,name:"\u5BFC\u51FA",icon:n,handle:go},{key:"edit",type:ge.BUTTON,name:"\u7F16\u8F91",icon:f,handle:K},{key:"setting",type:ge.BUTTON,name:"\u8BBE\u7F6E",icon:o,handle:()=>{p.value=!0}}];return(T,v)=>{const H=I("n-icon"),N=I("n-text"),x=I("n-button"),B=I("n-upload"),r=I("n-tooltip");return D(),z(pe,null,[W("div",{class:ie(["go-chart-edit-tools",[s(h).getChartToolsStatus,s(C)?"isMini":"unMini"]]),onClick:v[1]||(v[1]=l=>_.value&&(_.value=!1)),onMouseenter:L,onMouseleave:k},[We(M(H,{class:"asideLogo",size:"22"},{default:F(()=>[M(s(a))]),_:1},512),[[ze,s(h).getChartToolsStatus===s(Ie).ASIDE&&s(C)]]),(D(!0),z(pe,null,_e(s(E),(l,b)=>(D(),U(r,{key:l.key,disabled:!s(m)||s(u)&&i.value,trigger:"hover",placement:"left"},{trigger:F(()=>[W("div",wo,[l.type===s(ge).BUTTON?(D(),U(x,{key:0,circle:s(m),secondary:"",onClick:l.handle},{icon:F(()=>[s(m)?(D(),U(H,{key:0,size:"22"},{default:F(()=>[(D(),U(me(l.icon)))]),_:2},1024)):(D(),U(me(l.icon),{key:1}))]),default:F(()=>[We(M(N,{depth:"3"},{default:F(()=>[Ce(de(l.name),1)]),_:2},1536),[[ze,!s(m)]])]),_:2},1032,["circle","onClick"])):l.type===s(ge).IMPORTUPLOAD?(D(),U(B,{key:1,"file-list":s(c),"onUpdate:fileList":v[0]||(v[0]=O=>en(c)?c.value=O:null),"show-file-list":!1,customRequest:s(w),onBeforeUpload:s(d)},{default:F(()=>[M(x,{circle:s(m),secondary:""},{icon:F(()=>[s(m)?(D(),U(H,{key:0,size:"22"},{default:F(()=>[(D(),U(me(l.icon)))]),_:2},1024)):(D(),U(me(l.icon),{key:1}))]),default:F(()=>[We(M(N,{depth:"3"},{default:F(()=>[Ce(de(l.name),1)]),_:2},1536),[[ze,!s(m)]])]),_:2},1032,["circle"])]),_:2},1032,["file-list","customRequest","onBeforeUpload"])):he("",!0)])]),default:F(()=>[W("span",null,de(l.name),1)]),_:2},1032,["disabled"]))),128))],34),M(s(vo),{modelShow:p.value,"onUpdate:modelShow":v[2]||(v[2]=l=>p.value=l)},null,8,["modelShow"])],64)}}});var To=ce(So,[["__scopeId","data-v-4c257f27"]]);const xo=ue({__name:"index",setup(e){const n=re(),{handleContextMenu:t}=ut(),{dataSyncFetch:a}=ct();yn();const{mouseenterHandle:o,mouseleaveHandle:f,mousedownHandle:h,mouseClickHandle:y}=Lt(),g=(d,m,u)=>{if(n.getTargetChart.selectId.length>1)return m.filter(E=>[A.GROUP,A.DELETE].includes(E.key));const C=[];return u.status.lock?C.push(A.LOCK):C.push(A.UNLOCK),u.status.hide?C.push(A.HIDE):C.push(A.SHOW),d.filter(E=>!C.includes(E.key))},p=d=>{var m;return!!((m=d.chartConfig.filters)!=null&&m.length)},_=d=>{var L;const m=(L=d.chartConfig.filters)==null?void 0:L.map(k=>k.type==Nt.DATE&&k.from!="query"?221:450);if(!(m!=null&&m.length))return 0;const u=m==null?void 0:m.reduce((k,K)=>k+K+8),C=u?Math.ceil(u/d.attr.w):0;return C*24+(C-1)*8+16},i=P(()=>n.getEditCanvasConfig.chartThemeSetting),c=P(()=>{const d=n.getEditCanvasConfig.chartThemeColor;return wt[d]});P(()=>n.getEditCanvasConfig.filterShow);const w=P(()=>{const d=n.getEditCanvasConfig.background,m=n.getEditCanvasConfig.backgroundImage,E=n.getEditCanvasConfig.selectColor?{background:d||void 0}:{background:`url(${m}) no-repeat center center / cover !important`};return we(Y({},E),{width:"inherit",height:"inherit"})});return st(()=>{Tn(),a()}),(d,m)=>(D(),U(s(gn),{id:"go-chart-edit-layout",flex:!0,showTop:!1,showBottom:!0,depth:1,xScroll:!0,disabledScroll:!0,onMousedown:s(Ot),onDrop:s(Dn),onDragover:s(gt),onDragenter:s(gt)},{aside:F(()=>[M(s(To))]),bottom:F(()=>[M(s(po))]),default:F(()=>[M(s(Qn),null,{default:F(()=>[W("div",{id:"go-chart-edit-content",onContextmenu:m[0]||(m[0]=(...u)=>s(t)&&s(t)(...u))},[M(s(Gn),null,{default:F(()=>[W("div",{style:se(Y(Y({},s(Re)(s(n).getEditCanvasConfig)),s(w)))},[(D(!0),z(pe,null,_e(s(n).getComponentList,(u,C)=>(D(),z("div",{key:u.id},[u.isGroup?(D(),U(s(Ln),{key:0,groupData:u,groupIndex:C},null,8,["groupData","groupIndex"])):(D(),U(s(et),{key:1,"data-id":u.id,index:C,style:se(Y(Y({},s(Pe)(u.attr,C)),s(Dt)(u.styles))),item:u,onClick:E=>s(y)(E,u),onMousedown:E=>s(h)(E,u),onMouseenter:E=>s(o)(E,u),onMouseleave:E=>s(f)(E,u),onContextmenu:E=>s(t)(E,u,g)},{default:F(()=>[p(u)?(D(),U(s(dn),{key:0,class:"filter-content",componentIdx:u.id,attr:u.attr,filters:u.chartConfig.filters,type:u.chartConfig.category},null,8,["componentIdx","attr","filters","type"])):he("",!0),(D(),U(me(u.chartConfig.chartKey),{class:ie(["edit-content-chart",s(Qe)(u.styles.animations)]),chartConfig:u,themeSetting:s(i),themeColor:s(c),style:se(Y(Y(Y({},s(fn)(u.attr,_(u))),s(Re)(u.styles)),s(Ze)(u.styles)))},null,8,["class","chartConfig","themeSetting","themeColor","style"]))]),_:2},1032,["data-id","index","style","item","onClick","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))]))),128))],4)]),_:1})],32)]),_:1})]),_:1},8,["onMousedown","onDrop","onDragover","onDragenter"]))}});var Yo=ce(xo,[["__scopeId","data-v-53150d5c"]]);export{Yo as default};
